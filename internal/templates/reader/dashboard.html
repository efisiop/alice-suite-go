{{define "title"}}Reader Dashboard - Alice Suite{{end}}

{{define "nav"}}
<li class="nav-item">
    <a class="nav-link" href="/reader/interaction">Reading</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="/reader/my-page">My Page</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="#" id="logout-link-reader">Logout</a>
</li>
{{end}}

{{define "content"}}
<div class="row">
    <div class="col-md-12">
        <h1 class="mb-4">Reader Dashboard</h1>
        
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Start Reading</h5>
                        <p class="card-text">Continue your reading journey</p>
                        <a href="/reader/interaction" class="btn btn-primary">Open Book</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Reading Progress</h5>
                        <p class="card-text">View your reading statistics</p>
                        <a href="/reader/statistics" class="btn btn-outline-primary">View Stats</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">My Page</h5>
                        <p class="card-text">View your help requests</p>
                        <a href="/reader/my-page" class="btn btn-outline-primary">Go to My Page</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h5>Recent Activity</h5>
            </div>
            <div class="card-body">
                <div id="recent-activity">
                    <p class="text-muted">Loading activity...</p>
                </div>
            </div>
        </div>
    </div>
</div>

{{end}}

{{define "head"}}
{{end}}

{{define "scripts"}}
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('[dashboard.html] DOMContentLoaded fired');
    
    const token = getAuthToken();
    if (!token) {
        window.location.href = '/login';
        return;
    }

    // Attach logout handler
    const logoutLink = document.getElementById('logout-link-reader');
    if (logoutLink) {
        logoutLink.addEventListener('click', function(e) {
            e.preventDefault();
            if (window.logout) {
                window.logout();
            }
        });
    }

    // Load user info in navbar
    setTimeout(function() {
        if (typeof loadUserInfoInNavbar === 'function') {
            loadUserInfoInNavbar();
        }
    }, 500);
    
    // Load recent activity
    document.getElementById('recent-activity').innerHTML = '<p class="text-muted">No recent activity</p>';
});
</script>
{{end}}

